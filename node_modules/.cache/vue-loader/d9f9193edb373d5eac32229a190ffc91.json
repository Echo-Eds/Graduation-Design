{"remainingRequest":"D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\src\\views\\shopping\\cart.vue?vue&type=style&index=0&id=2cdc783d&scoped=true&lang=css","dependencies":[{"path":"D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\src\\views\\shopping\\cart.vue","mtime":1652769309493},{"path":"D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\node_modules\\css-loader\\dist\\cjs.js","mtime":1643167393479},{"path":"D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1643167394865},{"path":"D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\node_modules\\postcss-loader\\src\\index.js","mtime":1643167394154},{"path":"D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1643167392997},{"path":"D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1643167394348}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouaW5mb190aXRsZSB7DQogIHdpZHRoOiA5MDBweDsNCiAgbWFyZ2luOiA0MHB4IGF1dG87DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCi5pbmZvX3RpdGxlIHNwYW4gew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgZm9udC1zaXplOiAyNHB4Ow0KICBmb250LXdlaWdodDogNDAwOw0KfQ0KLm15TG9jYXQgew0KICBoZWlnaHQ6IDQwMHB4Ow0KfQ0KLnByaWNlIHsNCiAgZm9udC1zaXplOiAyNHB4Ow0KICBmb250LWZhbWlseTogIlRpbWVzIE5ldyBSb21hbiIsIFRpbWVzLCBzZXJpZjsNCiAgZm9udC13ZWlnaHQ6IDIwMDsNCiAgY29sb3I6IHJlZDsNCn0NCi51cE9yZGVyIHsNCiAgaGVpZ2h0OiAxMDBweDsNCn0NCi51cE9yZGVyIHNwYW4gew0KICBkaXNwbGF5OiBpbmxpbmU7DQogIGZvbnQtc2l6ZTogMjRweDsNCn0NCi5wcmljZSB7DQogIGNvbG9yOiBvcmFuZ2VyZWQ7DQp9DQo="},{"version":3,"sources":["D:\\SpringBoot\\demoSpringBootVue\\springbootvue\\src\\views\\shopping\\cart.vue"],"names":[],"mappings":";AAyOA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACV,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACjB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACpB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACvB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAClB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AACf;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAC5C,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAChB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACZ;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;AACf;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;EACZ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACjB;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACL,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAClB","file":"D:/SpringBoot/demoSpringBootVue/springbootvue/src/views/shopping/cart.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <SysHeader></SysHeader>\r\n  <IndexCarousel></IndexCarousel>\r\n  <el-row>\r\n    <div class=\"info_title\">\r\n      <span\r\n        ><el-icon><ShoppingCartFull /></el-icon>&nbsp;Cart</span\r\n      >\r\n      <br />\r\n      <span>购物车</span>\r\n    </div>\r\n  </el-row>\r\n  <el-row>\r\n    <el-col :span=\"4\"></el-col>\r\n    <el-col :span=\"16\">\r\n      <el-table\r\n        ref=\"multipleTableRef\"\r\n        :data=\"tableData\"\r\n        style=\"width: 100%\"\r\n        @selection-change=\"handleSelectionChange\"\r\n        :row-style=\"{ height: '70px' }\"\r\n        border\r\n      >\r\n        <el-table-column type=\"selection\" width=\"55\" />\r\n        <el-table-column label=\"\">\r\n          <template #default=\"scope\">\r\n            <el-image\r\n              :src=\"scope.row.iconPath\"\r\n              fit=\"contain\"\r\n              style=\"width: 100px; height: 100px\"\r\n              :preview-src-list=\"[scope.row.iconPath]\"\r\n            ></el-image>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"药品名称\" prop=\"name\"></el-table-column>\r\n        <el-table-column label=\"价格\" prop=\"price\">\r\n          <template #default=\"scope\">\r\n            <span class=\"price\">￥：{{ scope.row.price }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"购买数量\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-input-number\r\n              v-model=\"scope.row.medicineNum\"\r\n              :min=\"1\"\r\n              :max=\"99\"\r\n              @change=\"changeNum(scope.row.medicineId, scope.row.medicineNum)\"\r\n            ></el-input-number>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" align=\"center\" width=\"170px\">\r\n          <template #default=\"scope\">\r\n            <el-popconfirm\r\n              title=\"确定从购物车删除？\"\r\n              @confirm=\"handleDelete(scope.row.medicineId)\"\r\n            >\r\n              <template #reference>\r\n                <el-button color=\"#eebe77\">删除药品</el-button></template\r\n              >\r\n            </el-popconfirm>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <el-divider></el-divider>\r\n\r\n      <div style=\"text-align: right\">\r\n        <div style=\"padding: 10px 0\">\r\n          当前已选商品总价： <span class=\"price\">￥：{{ totalPrice }}</span>\r\n        </div>\r\n        <el-button\r\n          type=\"success\"\r\n          size=\"large\"\r\n          style=\"width: 200px\"\r\n          round\r\n          @click=\"upOrders\"\r\n          :disabled=\"disabled\"\r\n          >提交订单</el-button\r\n        >\r\n      </div>\r\n    </el-col>\r\n    <el-col :span=\"4\"></el-col>\r\n  </el-row>\r\n  <div style=\"width: 100%; height: 150px\"></div>\r\n  <SysBottom></SysBottom>\r\n</template>\r\n\r\n<script>\r\nimport SysHeader from \"../../components/sys/SysHeader.vue\";\r\nimport IndexCarousel from \"../../components/sys/IndexCarousel.vue\";\r\nimport SysBottom from \"../../components/sys/SysBottom.vue\";\r\n\r\nimport request from \"@/utils/request.js\";\r\nexport default {\r\n  name: \"cart\",\r\n  components: {\r\n    SysHeader,\r\n    IndexCarousel,\r\n    SysBottom,\r\n  },\r\n  data() {\r\n    return {\r\n      tableData: [],\r\n      multipleSelection: [],\r\n      totalPrice: 0,\r\n      str: JSON.parse(sessionStorage.getItem(\"user\")),\r\n      ordersNo: 0,\r\n      disabled: true,\r\n    };\r\n  },\r\n  mounted() {\r\n    this.load();\r\n  },\r\n  methods: {\r\n    load() {\r\n      this.tableData = [];\r\n\r\n      request.get(\"/cart/selectMyCart/\" + this.str.id).then((res) => {\r\n        console.log(res);\r\n        let medicineNUM = res.data.length;\r\n        //   this.CardList.length = professorNUM;\r\n\r\n        for (let flag = 0; flag < medicineNUM; flag++) {\r\n          this.tableData.push(res?.data[flag]);\r\n        }\r\n        console.log(this.tableData);\r\n      });\r\n    },\r\n    handleSelectionChange(val) {\r\n      console.log(val);\r\n      this.totalPrice = 0;\r\n      this.multipleSelection = val;\r\n      //计算总价\r\n      if (val && val.length) {\r\n        val.forEach((item) => {\r\n          this.totalPrice += item.medicineNum * item.price;\r\n        });\r\n      }\r\n      this.totalPrice = this.totalPrice.toFixed(2);\r\n      if (this.totalPrice > 0) {\r\n        this.disabled = false;\r\n      }\r\n      if (this.totalPrice == 0) {\r\n        this.disabled = true;\r\n      }\r\n    },\r\n    changeNum(id, num) {\r\n      console.log(id);\r\n      console.log(num);\r\n      console.log(this.str.id);\r\n      request\r\n        .post(\"/cart/updateNum/\" + num + \"/\" + id + \"/\" + this.str.id)\r\n        .then((res) => {\r\n          console.log(res);\r\n        });\r\n      this.totalPrice = 0;\r\n      this.multipleSelection.forEach((item) => {\r\n        this.totalPrice += item.medicineNum * item.price;\r\n      });\r\n      this.totalPrice = this.totalPrice.toFixed(2);\r\n      console.log(this.totalPrice);\r\n    },\r\n    upOrders() {\r\n      //创建订单\r\n      request\r\n        .post(\"/cart/addOrder/\" + this.str.id + \"/\" + this.totalPrice)\r\n        .then((res) => {\r\n          // console.log(res);\r\n          this.ordersNo = res.data;\r\n          //获取订单中的商品信息\r\n          this.multipleSelection.forEach((item) => {\r\n            let medicineId = item.medicineId;\r\n            let medicineNum = item.medicineNum;\r\n            request\r\n              .post(\r\n                \"/cart/addOrderMedicine/\" +\r\n                  this.ordersNo +\r\n                  \"/\" +\r\n                  medicineId +\r\n                  \"/\" +\r\n                  medicineNum\r\n              )\r\n              .then((res) => {\r\n                if (res.code == \"0\") {\r\n                  this.$router.push({\r\n                    path: \"/order\",\r\n                    query: {\r\n                      orderNo: this.ordersNo,\r\n                    },\r\n                  });\r\n                } else {\r\n                  this.$message({\r\n                    type: \"error\",\r\n                    message: res.msg,\r\n                    showClose: true,\r\n                    center: true,\r\n                  });\r\n                }\r\n              });\r\n          });\r\n        });\r\n      this.$message({\r\n        type: \"success\",\r\n        message: \"提交成功！\",\r\n        showClose: true,\r\n        center: true,\r\n      });\r\n    },\r\n\r\n    handleDelete(medicineId) {\r\n      request.delete(\"/cart/deleteRow/\" + medicineId + \"/\" + this.str.id).then((res) => {\r\n        if (res.code == \"0\") {\r\n          this.$message({\r\n            type: \"success\",\r\n            message: \"删除成功！\",\r\n            showClose: true,\r\n            center: true,\r\n          });\r\n        } else {\r\n          this.$message({\r\n            type: \"error\",\r\n            message: res.msg,\r\n            showClose: true,\r\n            center: true,\r\n          });\r\n        }\r\n        this.load();\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.info_title {\r\n  width: 900px;\r\n  margin: 40px auto;\r\n  text-align: center;\r\n}\r\n.info_title span {\r\n  display: flex;\r\n  justify-content: center;\r\n  font-size: 24px;\r\n  font-weight: 400;\r\n}\r\n.myLocat {\r\n  height: 400px;\r\n}\r\n.price {\r\n  font-size: 24px;\r\n  font-family: \"Times New Roman\", Times, serif;\r\n  font-weight: 200;\r\n  color: red;\r\n}\r\n.upOrder {\r\n  height: 100px;\r\n}\r\n.upOrder span {\r\n  display: inline;\r\n  font-size: 24px;\r\n}\r\n.price {\r\n  color: orangered;\r\n}\r\n</style>\r\n"]}]}